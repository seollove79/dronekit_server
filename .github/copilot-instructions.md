# 프로젝트 요구사항 문서 (PRD)

## 프로젝트 제목
다중 드론 제어 및 모니터링 API 서비스

## 목표
`dronekit-python`과 `FastAPI`를 사용하여 여러 대의 드론을 동시에 연결, 제어 및 모니터링할 수 있는 API 서비스를 개발합니다. 이 서비스는 드론 운영을 효율적으로 관리하기 위한 중앙화된 인터페이스를 제공합니다.

---

## 주요 기능

### 1. 드론 연결 관리
- **설명**: 여러 대의 드론과의 연결을 설정하고 관리합니다.
- **요구사항**:
  - MAVLink 프로토콜을 통한 드론 연결 지원.
  - 고유 식별자를 통해 모든 연결된 드론 나열.
  - 연결 손실 시 드론 재연결 기능.

### 2. 드론 제어
- **설명**: 드론 작업을 제어하기 위한 API를 제공합니다.
- **요구사항**:
  - 드론의 Arm/Disarm 기능.
  - 이륙 및 착륙 명령.
  - 웨이포인트 설정 및 미션 실행.
  - 드론 이동 제어(예: 고도, 방향, 속도).
  - Guide mode를 사용한 특정 지점으로의 이동 기능.
  - Return-to-Home(RTH) 기능.

### 3. 드론 모니터링
- **설명**: 드론의 실시간 텔레메트리 및 상태를 모니터링합니다.
- **요구사항**:
  - 텔레메트리 데이터 수집(GPS 위치, 고도, 배터리 상태, 속도 등).
  - 미션 진행 상황 및 드론 상태 모니터링.
  - 중요한 이벤트(예: 배터리 부족, 연결 손실)에 대한 알림 제공.

### 4. API 설계
- **설명**: 외부 클라이언트가 서비스와 상호작용할 수 있도록 RESTful API를 제공합니다.
- **요구사항**:
  - 드론 연결, 제어 및 모니터링을 위한 엔드포인트.
  - JSON 기반 요청 및 응답 페이로드 지원.
  - Swagger/OpenAPI를 사용한 API 문서화.

### 5. 보안
- **설명**: API 서비스에 대한 안전한 접근을 보장합니다.
- **요구사항**:
  - API 키 또는 OAuth2를 사용한 인증.
  - 사용자 역할(예: 관리자, 운영자)에 따른 역할 기반 접근 제어(RBAC).
  - 악의적인 요청을 방지하기 위한 입력 검증 및 정리.

### 6. 확장성
- **설명**: 여러 대의 드론과 동시 API 요청을 효율적으로 처리합니다.
- **요구사항**:
  - 최소 10대의 드론을 동시에 관리할 수 있어야 함.
  - FastAPI의 비동기 기능을 활용한 비동기 요청 처리.

### 7. 로깅 및 감사
- **설명**: 디버깅 및 감사 목적으로 로그를 유지합니다.
- **요구사항**:
  - 모든 API 요청 및 응답 로그 기록.
  - 드론 이벤트(예: 이륙, 착륙, 오류) 기록.
  - 특정 이벤트에 대한 로그 조회 메커니즘 제공.

---

## 기술 스택

- **백엔드 프레임워크**: FastAPI
- **드론 SDK**: dronekit-python
- **데이터베이스**: PostgreSQL (드론 데이터 및 로그 저장용)
- **인증**: OAuth2 또는 API 키 기반
- **배포**: Docker 컨테이너 및 Kubernetes 오케스트레이션

---

## 마일스톤

### 1단계: 핵심 기능
- FastAPI 프로젝트 구조 설정.
- 드론 연결 및 텔레메트리 모니터링 구현.
- 기본 제어 API 개발(예: Arm, 이륙, 착륙).

### 2단계: 고급 기능
- 웨이포인트 및 미션 관리 추가.
- 실시간 텔레메트리 스트리밍 구현.
- 보안 기능 추가(인증 및 RBAC).

### 3단계: 테스트 및 배포
- 단위 및 통합 테스트 작성.
- Docker 및 Kubernetes를 사용하여 서비스 배포.
- API 문서화 및 사용자 가이드 작성.

---

## 프로젝트 구조

다음은 FastAPI 프로젝트의 추천 구조입니다:

```
project_root/
├── app/
│   ├── main.py          # FastAPI 애플리케이션 초기화 및 라우터 포함
│   ├── models/          # Pydantic 모델 정의
│   │   └── __init__.py
│   ├── routers/         # API 라우터 정의
│   │   └── drones.py
│   └── services/        # 비즈니스 로직 및 서비스 계층
│       └── drone_service.py
├── __pycache__/         # Python 캐시 파일
└── instructions         # 프로젝트 요구사항 문서
```

이 구조는 모듈화와 유지보수를 용이하게 하며, 확장성을 고려한 설계입니다.

---

## 성공 지표
- 최소 10대의 드론을 동시에 연결 및 제어 가능.
- 대부분의 작업에 대해 500ms 이하의 API 응답 시간.
- API 서비스의 99.9% 가동 시간 보장.
